/** * @author: Andreas * @copyright: Flashutvecklaren.se All rights reserved. */package se.flashutvecklaren.bitmap{   import flash.display.BitmapData;   import flash.display.DisplayObject;   import flash.net.FileReference;   import flash.utils.ByteArray;      import mx.graphics.codec.IImageEncoder;   import mx.graphics.codec.JPEGEncoder;   import mx.graphics.codec.PNGEncoder;   /**    *  Class for saving an image of a DisplayObject to the users file system.    *  The image can be saved using PNG or JPG compression.    */   public class BitmapSaver   {      /**       *  Constructor.       */      public function BitmapSaver()      {      }      /**       *  Saves an images of a DisplayObject as a PNG file on the users filesystem.       *  @param rSource the DisplayObject to save an image of       *  @see #saveJPG()        */      public function savePNG(rSource:DisplayObject):void      {         save(rSource, new PNGEncoder(), '.png');      }      /**       *  Saves an images of a DisplayObject as a JPG file on the users filesystem.       *  @param rSource the DisplayObject to save an image of       *  @param rQuality a value between 0.0 and 100.0. The smaller the quality value, the smaller the file size of the resultant image. The default value is 50.0.       *  @see #savePNG()       */      public function saveJPG(rSource:DisplayObject, rQuality:Number = 50.0):void      {         save(rSource, new JPEGEncoder(rQuality), '.jpg');      }      /**       *  @private       *  Used for capturing and saving the image       */      protected function save(rSource:DisplayObject, rEncoder:IImageEncoder, rDefaultFileName:String):void      {         var tBD:BitmapData = new BitmapData(rSource.width, rSource.height);         tBD.draw(rSource);         var tBA:ByteArray = rEncoder.encode(tBD);         var tFR:FileReference = new FileReference();         tFR.save(tBA, rDefaultFileName);         tBD.dispose();         tBA.clear();      }   }}var tBS:BitmapSaver = new BitmapSaver();tBS.savePNG(displayObjectToBeSaved);<?xml version="1.0" encoding="utf-8"?><s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"                xmlns:s="library://ns.adobe.com/flex/spark"                xmlns:mx="library://ns.adobe.com/flex/mx"                width="200" height="130">	   <s:layout>      <s:VerticalLayout />   </s:layout>   <fx:Script>      <![CDATA[         import se.flashutvecklaren.bitmap.BitmapSaver;         protected function saveImg():void         {            var tBS:BitmapSaver = new BitmapSaver();            tBS.savePNG(this);         }      ]]>   </fx:Script>	   <s:Rect width="100" height="100">      <s:fill>         <s:SolidColor color="0xff0000" />      </s:fill>   </s:Rect>	   <s:Button click="saveImg()" label="Save" />	</s:Application>