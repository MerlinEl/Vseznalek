// Remove Unused Library Symbolsvar dom = fl.getDocumentDOM();if (dom == null){    alert('Please open a file.');}else{    var lib = dom.library;    var activeItem;    var isFound;    var item;    var libItems = lib.items;    fl.outputPanel.clear();    for ( var i = 0; i < libItems.length; i++ )    {        var curLibItemName = libItems[i].name;        var curLibItemSelection = lib.selectItem(curLibItemName, true, true);        var selectedItem = lib.getSelectedItems();        function scanTimeline(_timeline, _mainTimeline)        {            var timeline = _timeline;            var layerCount = timeline.layerCount;            while (layerCount--)            {                var frameCount = timeline.layers[layerCount].frameCount;                while (frameCount--)                {                    if (timeline.layers[layerCount].frames[frameCount] == undefined)                    {                        continue;                    }                    var elems = timeline.layers[layerCount].frames[frameCount].elements;                    var p = elems.length;                    while (p--)                    {                        // Check if it's an instance in the library                        if (elems[p].elementType == 'instance')                        {                            // Check if it's the same clip as our active check                            if (elems[p].libraryItem.name == activeItem.name)                            {                                found = true;                                var where;                                if(_mainTimeline == true)                                {                                    where = 'Located in the main timeline.';                                }                                else                                {                                    where = 'Located in the library item: ' + item.name;                                }                                frameCount = 0;                            }                        }                    }                }            }        }        function scanLibrary()        {            var items = lib.items;            for (var i = 0; i < items.length; i++)            {                item = items[i];                if(item.itemType == 'movie clip')                {                    scanTimeline(item.timeline, false);                }            }        }        // Safety check        if (selectedItem.length == 0)        {            alert('Please make a selection in the library.');        }        else        {            activeItem = selectedItem[0];            found = false;            // Scan the main timeline first            scanTimeline(dom.getTimeline(), true);            // Scan the library            scanLibrary();            if (found == false)            {                if (activeItem.linkageClassName != undefined)                {                    fl.trace(curLibItemName + ' was not found on the stage, but it does have a linkage name so it may be instantiated dynamically.  Use caution before deleting.');                }                else                {                    fl.trace(curLibItemName + ' was not found on the stage and will be removed.');                    lib.deleteItem(curLibItemName);                }            }        }       }}