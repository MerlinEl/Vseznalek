'================================================================'overwrite existing file'================================================================Const ForReading = 1Const OverwriteExisting = TRUEDim copyWalker, copyWalkerFull, copyCD, copyOutputcopyWalker = FalsecopyWalkerFull = FalsecopyCD = FalsecopyOutput = False'Show dialogue with choicesDim Input : Input = InputBox("Enter your choice:" & vbCrLf & Join(Array("1: Copy Walker", "2: Copy Walker And Air", "3: Copy Localization Script", "4: Copy Manual"), vbCrLf))Select Case Input Case "1" copyWalker = True Case "2" copyWalkerFull = True Case "3" copyCD = True Case "4" copyOutput = True Case Else MsgBox "Invalid Input"End Select'Define pathsDim rootDir, cdDir, outputDir, dataDir, appDir, objFSOrootDir = "../../@NS INTERACTIVE/"cdDir = "CD/"outputDir = "CD/Output/"dataDir = "CD/Output/data"'Define files to copyDim walkerFiles(1)walkerFiles(0) = "system.app\Walker.exe"walkerFiles(1) = "system.app\Walker.swf"Dim cdFiles(0)cdFiles(0) = "Smazat regiztraci z localization.vbs"'Get book destinationsSet objFSO = CreateObject("Scripting.FileSystemObject")Set objFile = objFSO.OpenTextFile("_CD_paths.txt")appDir = objFSO.GetAbsolutePathName(".")'For all book destinations copy filesDo Until objFile.AtEndOfStream	Dim bookDir, dataPath, cdPath    bookDir = objFile.ReadLine	dataPath = rootDir & bookDir & dataDir & "\"	cdPath = rootDir & bookDir & cdDir & "\" 		If copyWalker Then 		If not objFSO.FolderExists(dataPath) Then objFSO.CreateFolder dataPath End If		copyFilesList objFSO, walkerFiles, dataPath , OverwriteExisting 	End If		If copyCD Then 		If not objFSO.FolderExists(cdPath) Then objFSO.CreateFolder cdPath End If		copyFilesList objFSO, cdFiles, cdPath , OverwriteExisting 	End If	If copyWalkerFull Then		If not objFSO.FolderExists(dataPath) Then objFSO.CreateFolder dataPath End If		' copy system.app\* folders with content to destDir		' pram true overwrite all		objFSO.CopyFolder "system.app\*", dataPath, True		' copy system.app\{chosen list} files to destDir		copyFilesList objFSO, walkerFiles, dataPath , OverwriteExisting	End If	LoopMsgBox "Files have been copied.", 0, "CD Update"  Function copyFilesList(fso, flist, dir, overwrite)	For Each f In flist		If fso.FolderExists(dir) Then			fso.CopyFile f, dir, overwrite  		Else			Wscript.Echo "Target Folder does not exist."		End If	next	End FunctionFunction isFolderExists(fso, dir)   Dim msg   If (fso.FolderExists(dir)) Then      msg = dir & " true."   Else      msg = dir & " false"   End If   isFolderExists = msg   End FunctionFunction isFileExists(fso, fpath)   Dim msg   If (fso.FileExists(fpath)) Then      msg = fpath & " true."   Else      msg = fpath & " false"   End If   isFileExists = msg   End Function'Not work yetFunction createFolderTree(fso, strPath)  Dim tmpArr, tmpPath  tmpArr = Split(strPath, "\")  tmpPath = tmpArr(0)  For i = 1 To UBound(tmpArr)    If Not fso.FolderExists(tmpPath) Then      fso.CreateFolder tmpPath    End If    tmpPath = tmpPath & "\" & tmpArr(i)  NextEnd Function'MsgBox "Copying Files:" & vbNewline & Join(walkerFiles) & vbNewline & "have been copied to " & rootDir, 0, "CD Update"'objFSO.DeleteFile cdPath & cdFiles(0)'Wscript.Echo "Folder dataPath exists:" & isFolderExists(objFSO, dataPath)'Wscript.Echo "Folder cdPath exists:" & isFolderExists(objFSO, cdPath)'copyFilesList(objFSO, walkerFiles, dataPath , OverwriteExisting)'copyFilesList(objFSO, cdFiles, cdPath , OverwriteExisting)