  Boolean MacroInProgress = false;        private enum WM : uint {            KEYDOWN = 0x0100,            KEYUP = 0x101        }        protected override void WndProc(ref Message m) {            // include some variables for Locals/Watch Window.            IntPtr HWnd = m.HWnd;            IntPtr LParam = m.LParam;            int Msg = m.Msg;            IntPtr Result = m.Result;            IntPtr WParam = m.WParam;            Console.WriteLine("WM_MESSAGE = " + m.Msg.ToString());                       if (!MacroInProgress) {                if (m.Msg == (int)WM.KEYDOWN)  // WM_KEYDOWN = 0x0100,                {                    Console.WriteLine("WM_KEYDOWN");                    //WriteMessage(ref m);                    int a = m.WParam.ToInt32();                    int b = (int)Keys.Control;                    if (m.WParam.ToInt32() == (int)Keys.ControlKey) {                        Console.WriteLine("CTRL key has been pressed.");  // set a flag                        MacroInProgress = true;                    }                }                if (m.Msg == (int)WM.KEYUP)  // WM_KEYUP = 0x0101,                {                    if (m.WParam.ToInt32() == (int)Keys.ControlKey) {                        Console.WriteLine("CTRL key has been released.");  // set a flag                        MacroInProgress = false;                    }                }            } else {                if (m.Msg == (int)WM.KEYDOWN) {                    Console.WriteLine("WM_KEYDOWN");                    //WriteMessage(ref m);                    string keyPress = Enum.GetName(typeof(Keys), m.WParam.ToInt32());                    if (true) {                        Console.WriteLine(keyPress + " key has been pressed.");  // set a flag                    }                }                if (m.Msg == (int)WM.KEYUP) {                    if (m.WParam.ToInt32() == (int)Keys.ControlKey) {                        Console.WriteLine("CTRL key has been released.");  // set a flag                        MacroInProgress = false;                    }                }            }            base.WndProc(ref m);        }