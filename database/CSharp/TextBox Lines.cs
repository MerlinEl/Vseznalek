//You can also do this in a shorter way using LinQ. To count the lines and exlcude the last line if it is empty:var lines = tb.Lines.Count();lines -= String.IsNullOrWhiteSpace(tb.Lines.Last()) ? 1 : 0;//And to count only non-empty lines:var lines = tb.Lines.Where(line => !String.IsNullOrWhiteSpace(line)).Count();//OR//This will not count any empty lines as the endint count = tb.Lines.Length;while (count > 0 && tb.Lines[count - 1] == "") {    count--;}//Or, if you want to exclude also lines containing only whitespacesint count = tb.Lines.Length;while (count > 0 && tb.Lines[count - 1].Trim(' ','\t') == "" ) {    count--;}// OR//If WordWrap is set to true and you want the number of lines that are displayed, try:int count = textBox1.GetLineFromCharIndex(int.MaxValue) + 1;//Now count is the number of lines that are displayed, if the textBox is empty count will be 1//And to get the line number without the empty lines:if (textBox1.Lines.Length == 0) --count;foreach (string line in textBox1.Lines)  if (line == "") --count;