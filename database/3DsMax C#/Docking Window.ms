class MainViewWindow : global::Autodesk.Max.Plugins.ViewWindow{       IntPtr previousParent;       WindowStyles previousStyle;       public override IntPtr CreateViewWindow( IntPtr hParent, int x, int y, int w, int h )       {              this.previousParent = GetParent( Plugin.Instance.MainFrame.Handle );              this.previousStyle = GetWindowStyle( Plugin.Instance.MainFrame.Handle );               Form mainFrame = GetMyForm();              SetWindowStyle( mainFrame.Handle, WindowStyles.WS_CHILD | WindowStyles.WS_VISIBLE );              SetParent( mainFrame.Handle, hParent );               mainFrame.dockedInsideExtendedView = true;              return mainFrame.Handle;       }        public override void DestroyViewWindow( IntPtr hWnd )       {              GetMyForm().dockedInsideExtendedView = false;              SetWindowStyle( Plugin.Instance.MainFrame.Handle, this.previousStyle );              SetParent( Plugin.Instance.MainFrame.Handle, this.previousParent );              GetMyForm().FormBorderStyle = FormBorderStyle.Sizable;              GetMyForm().Close();       }        public override string Name       {              get { return "Main Window"; }       }        /// <summary>       /// Can only have one mainframe!       /// </summary>       public override int NumberCanCreate       {              get { return 1; }       }}