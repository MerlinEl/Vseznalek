procedure DistributeFile(const rootTargetPath, sourceFile: string);var  findRec: TFindRec;  bookDir: string;  targetFile: string;begin  //MsgBox('Search in Root dir: [ '+rootTargetPath + '\* ]', mbInformation, MB_OK);    if FindFirst(rootTargetPath + '\*', findRec) then        try        repeat					bookDir := findRec.Name;					if ( bookDir <> '.') and (bookDir <> '..') then					begin						if findRec.Attributes and FILE_ATTRIBUTE_DIRECTORY = 0 						then //Get files							//MsgBox('Found file:' + bookDir, mbInformation, MB_OK);						else //Get directories							begin							//MsgBox('Found dir:' + bookDir, mbInformation, MB_OK);							targetFile := rootTargetPath + '\' + bookDir + '\InteligntFrame.swf';							//copy source_file in to targetFile							MsgBox('copy file:' + sourceFile + ' to : ' + targetFile, mbInformation, MB_OK);							FileCopy(sourceFile, targetFile, false); //FailIfExists == false							end;					end;        until not FindNext(findRec);        finally            FindClose(findRec);        end;end;function NextButtonClick(CurPageID: Integer): Boolean;begin  Result := True;  if (CurPageID = wpReady) then begin    MsgBox('Aplikuji Patch do kořenové složky [ '+ExpandConstant('{app}')+' ].', mbInformation, MB_OK);    //DistributeFile( ExpandConstant('{#Root_Dir}'),  ExpandConstant('{src}\InteligntFrame.swf') );    end;end;