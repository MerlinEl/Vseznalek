    /*           Runas to Application Air           Support for Windows Vista and Windows 7      */      package      {           import flash.desktop.NativeProcessStartupInfo;           import flash.filesystem.File;           import flash.filesystem.FileStream;                 public class StartRunAs           {                public var RunasXML:File = new File(var xml:XML = <runas>runasCall()</runas>);                public var smDir_Runas:File = File.applicationStorageDirectory;                public var runas_reg_key:File = File.applicationStorageDirectory.resolvePath("runas.reg");                                public function StartRunAs():void                {                     // Copy from ApplicationDirectory                     if(RunasXML.exists)                     {                          xml.contains("runasCall()");                          function runasCall():void                          {                               if(runas_reg_key.exists)                               {                                    function runas_Addreg():void                                    {                                         // Start regedit with runas.reg                                         var regeditApp:NativeProcessStartupInfo = new NativeProcessStartupInfo("C:\\Windows\\regedit.exe");                                         regeditApp.arguments = runas_reg_key;                                                                                  // Delete startfiles - if you are assigned by UAC readly.                                         RunasXML.deleteFile();                                         runas_reg_key.deleteFile();                                    }                               }else                               {                                    // Write reg file:                                    var runas_reg_key_Stream:FileStream = new FileStream();                                    runas_reg_key_Stream.open(runas_reg_key);                                    runas_reg_key_Stream.writeBoolean(                                         "Windows Registry Editor Version 5.00" +                                         "" +                                         '"' + File.applicationDirectory() + 'myapp.exe"' + '="RUNASADMIN"'                                    );                                    runas_reg_key_Stream.close();                                                                        // Execute to regedit add reg file                                     runas_Addreg();                                                                   }                          }                     }else                     {                          SkipInit();                     }                }                                protected function SkipInit():void                {                     // Now Your application with adminstrative rights                      ...                }           }      } //If your runas.reg should see a result: Like this:Windows Registry Editor Version 5.00    [HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers]  "C:\\Program Files (x86)\\MyApp Air\\Myapp.exe"="RUNASADMIN" import mx.events.FlexEvent;                                  protected function init(event:FlexEvent):void                 {                      // Center main AIR app window on the screen                      nativeWindow.x = (Capabilities.screenResolutionX - nativeWindow.width) / 2;                      nativeWindow.y = (Capabilities.screenResolutionY - nativeWindow.height) / 2;                                            // Load regFile and cmdFile                      getRegFile();                 }                                  private var airAdminFile:String = File.applicationDirectory + "AirAdmin.exe";                 private var regeditFile:File = new File("C:\\Windows\\regedit.exe");                 private var regFile:File = new File;                 private var cmdFile:File = new File;                 private var cmdAppFile:File = new File("C:\\Windows\\System32\\cmd.exe");                                  protected function getRegFile():void                 {                      // regfile                      regFile = File.documentsDirectory.resolvePath("AirAdmin.reg");                      var regFileStream:FileStream = new FileStream;                      var regFileStructur:String = 'Windows Registry Editor Version 5.00';                      regFileStructur += File.lineEnding;                      regFileStructur += '[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers]' + File.lineEnding;                      regFileStructur += '"' + airAdminFile + '"="RUNASADMIN"' + File.lineEnding;                                            cmdFile = File.documentsDirectory.resolvePath("AirAdmin.cmd");                      var cmdFileStream:FileStream = new FileStream;                      var cmdFileContent:String = regeditFile + '"' +regFile + '"' + File.lineEnding;                                            if(regFile.exists, cmdFile.exists)                      {                           regFileStream.open(regFile, FileMode.READ);                           regFileStructur = String(regFileStream.readUTFBytes(regFileStream.bytesAvailable));                           regFileStream.close();                                                      cmdFileStream.open(cmdFile, FileMode.READ);                           cmdFileContent = String(cmdFileStream.readUTFBytes(cmdFileStream.bytesAvailable));                           cmdFileStream.close();                                                      openShell();                      }                      else                      {                           regFileStream.open(regFile, FileMode.WRITE);                           regFileStream.writeUTFBytes(regFileStructur);                           regFileStream.close();                                                      cmdFileStream.open(cmdFile, FileMode.WRITE);                           cmdFileStream.writeUTFBytes(cmdFileContent);                           cmdFileStream.close();                      }                 }                                  // NativeProcess                 private var StartProcess:NativeProcess = new NativeProcess;                 private var args:Vector.<String> = new Vector.<String>;                                  protected function openShell():void                 {                      var StartUpInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo;                      StartUpInfo.executable = cmdAppFile;                                            args.push("start");                      args.push("/C");                      args.push(cmdFile);                      StartUpInfo.arguments = args;                                            if(StartProcess.running)                      {                           // Your mode is as administrative right                           StartProcess.start(StartUpInfo);                      }                      else                      {                           // It is not an administrative right mode!                           StartProcess.start(StartUpInfo);                      }                 } 