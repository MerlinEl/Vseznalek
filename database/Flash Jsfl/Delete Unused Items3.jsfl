function main(){		if (doc == null) {		alert('Please open a file.');		return;	}		var lib = doc.library;	var libItems = lib.items;	var unused_items = [];	fl.outputPanel.clear();	trace("Processing...")	for ( var i = 0; i < libItems.length; i++ ) {				// get library item name		var libItemName = libItems[i].name;		// select item		lib.selectItem(libItemName, true, true); 		// get selection		var librarySelection = lib.getSelectedItems();		// check if library are not empty		if (librarySelection.length == 0) {						alert('Library are empty.');			return;		}		// get library item			var libraryActiveItem = librarySelection[0];		// Scan the main timeline first		var isFound = scanTimeline(doc.getTimeline(), libraryActiveItem);		if (!isFound) {						unused_items.push(libraryActiveItem);			/*if (libraryActiveItem.linkageClassName != undefined) {								fl.trace(libItemName + ' was not found on the stage, but it does have a linkage name so it may be instantiated dynamically.  Use caution before deleting.');							} else {								fl.trace(libItemName + ' was not found on the stage and will be removed.');				//lib.deleteItem(libItemName);			}*/		}	}	ctrace("unused_items:{0}",unused_items)	for each (item in unused_items) lib.selectItem(item.name, false, true); // item name | replace selection | select	trace("Done!")}function scanTimeline(_timeline, _libraryActiveItem) {			var found = false;			var timeline = _timeline;	var layerCount = timeline.layerCount;	while (layerCount--) {				var frameCount = timeline.layers[layerCount].frameCount;				while (frameCount--) {						if (timeline.layers[layerCount].frames[frameCount] == undefined) {				continue;			}			var elems = timeline.layers[layerCount].frames[frameCount].elements;			var p = elems.length;			while (p--) {								// Check if it's an instance in the library				if (elems[p].elementType == 'instance') {										// Check if it's the same clip as our active check					if (elems[p].libraryItem.name == _libraryActiveItem.name) {												found = true;						frameCount = 0; // stop while						layerCount = 0; // stop while					}				}			}		}	}	return found;}