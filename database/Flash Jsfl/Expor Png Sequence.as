//Export each of selected items to png//**************************************************//fl.outputPanel.clear();//clear console;//ORIEN_TOOLS = false //force reload all librariesfl.runScript(fl.configURI + 'Orien/OrienTools.jsfl');//**************************************************//var trace = fl.trace;var doc = fl.getDocumentDOM();var sel = doc.selection;if (doc != null && sel.length > 0) {	if (confirm('Are you sure you want to export PNG sequence?')) {		esportPngSequence();	}}function esportPngSequence() {	var exportDir = setupExportFolder();	for (var i = 0; i < sel.length; i++) {		// select elements one by one		var ele = sel[i];		doc.selectNone();		doc.selection = [ele];		exportItemAsPng(ele, exportDir, i);	}		openFolder(exportDir);}function getFolder(str){	var index = str.lastIndexOf("/");	if (index != -1)		 str = str.substring(0,index+1);	return str;}// Set the save location to the JSFL folder in the same directory as the scriptfunction setupExportFolder() {	var folder = getFolder(fl.scriptURI) + "ExportPng/";	if (FLfile.exists(folder)) {		return folder;	}	FLfile.createFolder(folder);	return folder;}// Open directory in explorerfunction openFolder(folder){	if (!FLfile.exists(folder)) return;	var normal_path = FLfile.uriToPlatformPath(folder)	FLfile.runCommandLine("explorer " + normal_path);}function exportItemAsPng(ele, saveDir, index) {	//Get the selected component name	var eleName = "";	switch (ele.elementType) {		case "instance" :			eleName = ele.name;			break;		default :			eleName = "image_" + index;	}	//trace("ele:"+ele + " name:"+eleName + " type:"+ ele.elementType +" width:" + ele.width + " height:"+ele.height);	// build a filename using the linkageIdentifier 	var pngName = saveDir + eleName + ".png";	// array of selected items in the document	var w = ele.width;	var h = ele.height;	// copy the current selection from the document and writes it to the Clipboard.	doc.clipCopy();	// Create a new temporary document to paste the clip held in the clipboard 	fl.createDocument();	// get a handle on the currently focused document (the temporary one)	var exportdoc = fl.getDocumentDOM();		trace("exportdoc:"+exportdoc)	// Setup the document to use the profile we generated for it useing 	// the tenmplate	//exportdoc.importPublishProfile(saveDir);	//exportdoc.currentPublishProfile = "png";	// pastes the contents of the Clipboard into the document, defaults to 	// adding it at the center of the document    	exportdoc.clipPaste();	// Selects all items on the Stage;	exportdoc.selectAll();	// We are only adding one item to each document so we only need to get the ;	// first item in the array of selected items	var selectedItem = exportdoc.selection[0];	// set the dimensions of the output movie to match the dimensions of our selected clip	exportdoc.width = Math.floor(w);	exportdoc.height = Math.floor(h);	// Move the selection to fit the dimensions of the export movie. 	exportdoc.moveSelectionBy({x:-selectedItem.left, y:-selectedItem.top});	// Deselect the selected item;	exportdoc.selectNone();	// Export the element as Png.;	exportdoc.exportPNG(pngName,true,true);	// access the document that is currently focused (the temporary one) and;	// close it. Do not promt the user to save changes	exportdoc.close(false);	// trace its name in the output panel;	fl.trace('saving:' + pngName);}