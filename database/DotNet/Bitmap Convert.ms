How to convert MXS and dotNet native variables and arrays---------------------------------------------------------------- Load BitmapOperations assemblyassemblyFileName = "BitmapOperations.dll"dotnet.LoadAssembly assemblyFileName-- Get BitmapConversion class BitmapConversion = dotNetClass "BitmapOperations.Conversion"-- Convert stringBitmap = BitmapConversion.FromStringBuffer stringBuffer bitmapWidth bitmapHeight bitmapFormat--------------------------------------------------------------stringBuffer = nodeCurrent.InnerTextwidthImage = 256heightImage = 256formatImage = "RGB"pathAssembly = (symbolicPaths.getPathValue $macroScripts)+"\\BitmapOperations.dll"dotnet.LoadAssembly pathAssemblyhBitmapConversion = dotNetClass "BitmapOperations.Conversion"hBitmap = hBitmapConversion.FromStringBuffer stringBuffer widthImage heightImage formatImage hBitmap.Save (pathDirectoryWork+"/"+urlNode)hBitmap.Dispose()--------------------------------------------------------------hConvert = dotNetClass "System.Convert"arrayPixels = hConvert.FromBase64String stringPixelsbytesPixel = 0case formatImage of (  "RGB":   ( bytesPixel = 3 )  "RGBA":  ( bytesPixel = 4 )  default: ( format "readNodePixel :: Unknown format: % !\n" formatImage ))countPixels = widthImage*heightImageif (bytesPixel > 0) then (  if ( countPixels != (arrayPixels.Count/bytesPixel) ) then (    method = "dotNet"    case method of (      "3dsMax": (        bitmapImage = bitmap widthImage heightImage filename:filenameImage        for yPixel = 1 to heightImage do (          colorsRow = #()          for xPixel = 1 to widthImage do (            iPixel = (widthImage*(yPixel-1))+xPixel            jPixel = ((iPixel-1)*bytesPixel)+1            redPixel = (arrayPixels as integer)            greenPixel = (arrayPixels as integer)            bluePixel = (arrayPixels as integer)            alphaPixel = 255            if (formatImage == "RGBA") then ( alphaPixel = (arrayPixels as integer) )            colorPixel = color redPixel greenPixel bluePixel alphaPixel            colorsRow = colorPixel          )          pointStart = point2 0 (yPixel-1)          setPixels bitmapImage pointStart colorsRow        )        isSaved = save bitmapImage quiet:false        close bitmapImage      )      "dotNet": (        iWidth = dotNetObject "System.Int32" widthImage        iHeight = dotNetObject "System.Int32" heightImage        hBitmap = dotNetObject "System.Drawing.Bitmap" iWidth iHeight        for yPixel = 1 to heightImage do (          colorsRow = #()          for xPixel = 1 to widthImage do (            iPixel = (widthImage*(yPixel-1))+xPixel            jPixel = ((iPixel-1)*bytesPixel)+1            redPixel = (arrayPixels as integer)            greenPixel = (arrayPixels as integer)            bluePixel = (arrayPixels as integer)            alphaPixel = 255            if (formatImage == "RGBA") then ( alphaPixel = (arrayPixels as integer) )            hColorPixel = (hColor.FromARGB alphaPixel redPixel greenPixel bluePixel)            hBitmap.SetPixel (xPixel-1) (yPixel-1) hColorPixel          )        )        hBitmap.Save filenameImage        hBitmap.Dispose()      )    )  ))