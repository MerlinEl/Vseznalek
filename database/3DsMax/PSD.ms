http://lonerobot.net/?page_id=1079http://discourse.techart.online/t/automating-photoshop-via-3dsmax-with-dotnet-and-com-interop/466/25http://www.lonerobot.com/DotNetControls/PhotoShopInterop.zipBitmapLayerManager-- make sure this points to where your assembly is houseddotnet.loadassembly ((getDir #scripts) +@"\LoneRobot\ClassLib\PhotoShop.dll")dotnet.loadassembly ((getDir #scripts) +@"\LoneRobot\ClassLib\Interop.Photoshop.dll")oPhotoShop = dotnetobject "LoneRobot.Imaging.PhotoshopBot"--- Setup the TGA optionsoTGA = dotnetobject "LoneRobot.Imaging.ImageTypes+TGA"show oTGA--  .AlphaChannels : <System.Boolean>--   .BitsPerPixel : <LoneRobot.Imaging.ImageTypes+Tga+TGAResolution>--   .RLECompression : <System.Boolean>-- .bitsperpixel is an enumeration, so will need to be specified if you want an alpha channel to be savedshow (dotnetclass "LoneRobot.Imaging.ImageTypes+Tga+TGAResolution")-- dotNetClass:LoneRobot.Imaging.ImageTypes+Tga+TGAResolution--   .TGA16Bit : <LoneRobot.Imaging.ImageTypes+Tga+TGAResolution>, read-only, static--   .TGA24bit : <LoneRobot.Imaging.ImageTypes+Tga+TGAResolution>, read-only, static--   .TGA32bit : <LoneRobot.Imaging.ImageTypes+Tga+TGAResolution>, read-only, staticoTGA.AlphaChannels = trueoTGA.RLECompression = true-- set the bit depth to include the 8 bit aplha channeloTGA.BitsPerPixel = (dotnetclass "LoneRobot.Imaging.ImageTypes+Tga+TGAResolution").TGA32bitoTGA.BitsPerPixel.value__-- 32oPhotoShop.saveas "c:\	est32" oTGAClick the Windows "Start" button. Click "All Programs," then click "Microsoft .NET Framework" to view the Windows programming tools. Click "Visual Studio" to open your workspace.Click "File," then click "Open." Double-click the SLN file for your Web project. All C# programming application projects end with the SLN extension.Load your PSD file to initialize and prepare it for the new layer. Type the following code into your C# code file:PsdFile psd = new PsdFile();psd.Load("c:\myfile.psd");Replace "myfile.psd" with your own PSD file name.Create a new layer. Type the following code to add the layer:TreeNode layer = new TreeNode("Layer Name=NewLayer");You can replace "NewLayer" with your own layer name.Add the layer to the PSD file. The image is loaded and the layer is created, so now you combine the two to add the layer to your image. Add the final code:psd.Nodes.Add(layer);