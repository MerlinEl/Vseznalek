@echo offecho                   ----------------------echo                   -== Disk E: Switch =--echo                   ----------------------if exist E:\Drive.bat (echo J: drive will be set to E:\ ...pausesubst E: /Dsubst E: J:\if exist E:\Sprog_Home (move J:\SProg J:\Sprog_Workmove J:\Sprog_Home J:\SProg)) else (echo T: drive will be set to E:\ ...pauseif exist E:\Sprog_work (move J:\SProg J:\SProg_Homemove J:\Sprog_Work J:\SProg)subst E: /Dsubst E: T:\)@echo offecho                   ----------------------echo                   -== Disk E: Switch =--echo                   ----------------------echo .....................................................echo 1. Homeecho 2. Workecho 3. Abortecho .....................................................set /P CH="Enter choice: "if "%CH%"=="1" goto HOif "%CH%"=="2" goto WOif "%CH%"=="3" goto AB:HOif exist J:\Sprog_work (move J:\SProg J:\SProg_homemove J:\Sprog_work J:\SProg) else (echo Sprog is already set to Home.)if not exist E:\Drive.bat (subst E: /Dsubst E: T:\) else (echo Current Disk si already set to Home.)goto:END:WOif exist E:\Drive.bat (subst E: /Dsubst E: J:\) else (echo Current Disk si already set to Work.if exist J:\SProg_home (move J:\SProg J:\Sprog_workmove J:\SProg_home J:\SProg) else (echo Sprog is already set to Work.)goto:END:ENDexit@echo offIF EXIST e:\work.txt (echo je to disk Techo jo jo) ELSE (echo filename. missing.)pauseThe old parse-time trap.At parse time, variables are substituted at their values at THAT time.If you wish to use the dynamically-assigned value, you need to eitherreconstruct the codeif "%weekday%"=="Sun" set dailydir=1_Sunif "%weekday%"=="Mon" set dailydir=2_Monif "%weekday%"=="Tue" set dailydir=3_Tueif "%weekday%"=="Wed" set dailydir=4_Wedif "%weekday%"=="Thu" set dailydir=5_Thuif "%weekday%"=="Fri" set dailydir=6_Friif "%weekday%"=="Sat" set dailydir=7_Satif "%backuptype%"=="weekly" (set bkdir=\weekly\) else (set bkdir=\daily\%dailydir%)ORa) Append the option ENABLEDELAYEDEXPANSION to the SETLOCALANDb) useset bkdir=\daily\!dailydir!(!) not (%) in the original code.(seeSETLOCAL /?from the prompt or read earlier posts here for more info)