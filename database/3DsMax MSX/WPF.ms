global Window(   if heapSize < 100000000 do heapSize = 100000000 --100Mb      Local Class_AppSDK = dotnetclass "ManagedServices.AppSDK"   Local Class_MediaColor = dotnetclass "System.Windows.Media.Color"   Local Class_XamlReader = dotnetclass "System.Windows.Markup.XamlReader"      fn RandomRGB = Class_MediaColor.FromArgb 255 (random 1 255) (random 1 255) (random 1 255)      -- Window   if Window != undefined do Window.close()   XamlString =    "   <Window      xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"      xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"      Title=\"MainWindow\" Height=\"350\" Width=\"525\">      <Grid>         <Grid.RowDefinitions>            <RowDefinition Height=\"Auto\"/>            <RowDefinition />         </Grid.RowDefinitions>         <StackPanel Orientation=\"Horizontal\">            <Button Name=\"CreateButton\" Content=\"Create Button\" Margin=\"2\" Padding=\"2\"/>            <Button Name=\"DeleteButton\" Content=\"Delete Button\" Margin=\"2\" Padding=\"2\"/>         </StackPanel>         <ListView Grid.Row=\"1\" Name=\"MainPanel\" Background=\"DarkCyan\"/>      </Grid>   </Window>   "   Window = Class_XamlReader.Parse XamlString      -- Create Button   CreateButton = Window.findname "CreateButton"   fn CreateControls Sender Arg =   (      MainPanel = Window.findname "MainPanel"      for i = 1 to 2 do      (         -- Panel         Panel = dotnetobject "System.windows.Controls.WrapPanel"         Panel.Background = dotnetobject "System.Windows.Media.SolidColorBrush" (RandomRGB())         Panel.Margin = dotnetobject "System.Windows.Thickness" 0 30 0 30 -- Left Top Right Bottom         for x = 1 to 40 do         (            Rand = random 1 3            Control = case Rand of            (               1:               (                  Button = dotNetObject "System.windows.Controls.button"                  Button.Foreground = dotnetobject "System.Windows.Media.SolidColorBrush" (RandomRGB())                  Button.BorderBrush = dotnetobject "System.Windows.Media.SolidColorBrush" (RandomRGB())                  Button.Content = "Test"                  Button               )               2:               (                  Spinner = dotNetObject "System.windows.Controls.Slider"                  Spinner.value = random 1 100                  Spinner.Width = 75                  Spinner               )               3:               (                  CheckBox = dotNetObject "System.windows.Controls.CheckBox"                  CheckBox.Content = "Test"                  CheckBox               )            )            Panel.Children.add Control         )         MainPanel.Items.add Panel      )   )   dotNet.AddEventHandler CreateButton #Click CreateControls   dotNet.SetLifeTimeControl CreateButton #dotNet      -- Delete Button   DeleteButton = Window.findname "DeleteButton"   fn DeleteControls Sender Arg =   (      MainPanel = Window.findname "MainPanel"      MainPanel.Items.Clear()   )   dotNet.AddEventHandler DeleteButton #Click DeleteControls   dotNet.SetLifeTimeControl DeleteButton #dotNet      -- Show Window   (dotnetobject "System.Windows.Interop.WindowInteropHelper" Window).owner = dotnetobject "IntPtr" (windows.getMAXHWND())   Class_AppSDK.ConfigureWindowForMax Window   Window.show())