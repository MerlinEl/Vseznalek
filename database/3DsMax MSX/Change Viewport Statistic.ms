--******************************************************************************************************-- Created: 		22-03-2014   21:21h-- Last Updated:	24-10-2016-- Version:			2.00---- Author :  Kostadin Kotev / miau_u@yahoo.com / http://miauumaxscript.blogspot.com/-- Version:  3ds max 2009 (10) (should work in older versions too!)---- Discription: Changes the Viewport Statistics.-- Usage: RUN IT---- Idea: EricChadwick /http://ericchadwick.com//----******************************************************************************************************-- MODIFY THIS AT YOUR OWN RISKmacroscript miauuViewportStatisticsChangercategory:"miauu"tooltip:"Change Viewport Statistic"buttonText:"Change Viewport Statistic"(	global rol_miauuViewportStatistic	try(destroyDialog rol_miauuViewportStatistic)catch()	rollout rol_miauuViewportStatistic "Viewport Statistic"	(		local curMaxVersion = ((maxversion())[1] / 1000)		checkbox chkbtn_polygon "Polygon Count" pos:[5,5] checked:true		checkbox chkbtn_triangle "Triangle Count" pos:[5,25] checked:true		checkbox chkbtn_edge "Edge Count" pos:[5,45] checked:true		checkbox chkbtn_vertex "Vertex Count" pos:[5,65] checked:true		checkbox chkbox_fps "FPS" pos:[5,85] checked:false		radiobuttons rb_objects "" labels:#("Total", "Selection", "Total + Selection") default:1 columns:1 offset:[60,-80]		function ChangeStatistic =		(			dialogMonitorOPS.UnRegisterNotification id:#miauuChangeStatisticsSettingsID			dialogMonitorOps.enabled = true			function miauuChangeStatisticsSettings = 			(								local type = case rb_objects.state of					(						1: "Total"						2: "Selection"						3: "Total + Selection"					)				local BM_SETCHECK = 241					local BN_CLICKED = 0				local WM_COMMAND = 273				local TCM_SETCURFOCUS = 0x1330				--	""				--	"max 2017"				local statisticsTabIndex = if curMaxVersion < 19 and curMaxVersion > 14 then 6 else 5				local hwnd = DialogMonitorOPS.GetWindowHandle()				local hwnd_title = UIAccessor.GetWindowText hwnd				if (hwnd_title == "Viewport Configuration") then				( 					for kidHWND in (UIAccessor.GetChildWindows hWND) where ((UIAccessor.GetWindowClassName kidHWND) == "SysTabControl32") do					(						UIAccessor.SendMessage kidHWND TCM_SETCURFOCUS statisticsTabIndex 0					)					controls = windows.getChildrenHWND hwnd					show = undefined					for child in controls do					(						if (child[5] == type) do						(							show = child						)						if (child[5] == "Total") do (UIAccessor.SendMessage child[1] BM_SETCHECK 0 0)						if (child[5] == "Selection") do (UIAccessor.SendMessage child[1] BM_SETCHECK 0 0; print "Selection is ON")						if (child[5] == "Total + Selection") do (UIAccessor.SendMessage child[1] BM_SETCHECK 0 0)						if (child[5] == "Polygon Count") do (UIAccessor.SendMessage child[1] BM_SETCHECK (if chkbtn_polygon.checked then 1 else 0) 0)						if (child[5] == "Triangle Count") do (UIAccessor.SendMessage child[1] BM_SETCHECK (if chkbtn_triangle.checked then 1 else 0)  0)						if (child[5] == "Edge Count") do (UIAccessor.SendMessage child[1] BM_SETCHECK (if chkbtn_edge.checked then 1 else 0)  0)						if (child[5] == "Vertex Count") do (UIAccessor.SendMessage child[1] BM_SETCHECK (if chkbtn_vertex.checked then 1 else 0)  0)						if (child[5] == "Frames Per Second") do (UIAccessor.SendMessage child[1] BM_SETCHECK (if chkbox_fps.checked then 1 else 0)  0)					)-- 					--					if show != undefined do					(						UIAccessor.SendMessage show[1] BM_SETCHECK 1 0						windows.sendMessage (UIAccessor.getParentWindow show[1]) WM_COMMAND ((bit.shift BN_CLICKED 16) + (UIAccessor.getWindowResourceID hwnd)) show[1] 						uiAccessor.sendMessageID hwnd #IDOK					)					UIAccessor.PressButtonByName hwnd "OK"				) 				true			)			dialogMonitorOPS.RegisterNotification miauuChangeStatisticsSettings id:#miauuChangeStatisticsSettingsID			max vptconfig			dialogMonitorOPS.UnRegisterNotification id:#miauuChangeStatisticsSettingsID			dialogMonitorOps.enabled = false		)				on chkbtn_polygon changed state do ChangeStatistic()		on chkbtn_triangle changed state do ChangeStatistic()		on chkbtn_edge changed state do ChangeStatistic()		on chkbtn_vertex changed state do ChangeStatistic()		on chkbox_fps changed state do ChangeStatistic()				on rb_objects changed state do ChangeStatistic()				on rol_miauuViewportStatistic open do		(			ChangeStatistic()		)	)	createdialog rol_miauuViewportStatistic width:220)